#!/bin/bash

dir=${PWD##*/}

gh_pass() {
	read -resp $'Tell me your secrets:\n' kpw
	echo $kpw | keepassxc-cli clip $HOME/.kpxc/kpxc.kdbx GitHub 2 &> /dev/null & 
	sleep 0.5s
	ghpw=$(xclip -o -selection clipboard)
	echo $ghpw
	unset ghpw
}

create_gh() {
	ghpw=$(gh_pass)
	curl -X POST https://api.github.com/user/repos -u scbrickley:$ghpw -d "{\"name\": \"$dir\"}" &> /dev/null &
	unset ghpw
}

publish_gh() {
	create_gh
	git remote add origin git@github.com:scbrickley/"$dir".git
	git add .
	git commit -m "Initial commit"
	git push -u origin master
}

mirror_gh() {
	create_gh
	git remote add ghm git@github.com:scbrickley/"$dir".git
	git add .
	git commit -m "GitHub mirror"
	git push -u ghm master
}
